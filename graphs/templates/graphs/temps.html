{% extends "base.html" %}

{% block content %}
  <table class="table table-striped table-hover table-sm mt-3">
    <thead>
      <tr>
        <th style="width:5%; text-align: center;">#</th>
        <th style="width:20%; text-align: center;">IP</th>
        <th style="width:20%; text-align: center;">Pai</th>
        <th style="width:20%; text-align: center;">Endereço</th>
        <th style="width:15%; text-align: center;">Temperatura</th>
        <th style="width:30%; text-align: center;">Horário</th>
      </tr>
    </thead>
    <tbody id="auto-tbody">
    </tbody>
  </table>
  <script>
    function fdt(txt) {
      let date = new Date(txt);
      let year = date.getFullYear();
      let month = String(date.getMonth() + 1).padStart(2, '0');
      let day = String(date.getDate()).padStart(2, '0');
      let hours = String(date.getHours()).padStart(2, '0');
      let minutes = String(date.getMinutes()).padStart(2, '0');
      let seconds = String(date.getSeconds()).padStart(2, '0');

      return `${day}/${month}/${year} ${hours}:${minutes}:${seconds}`;
    }

    fetch("/graphs/temp?page=1&quant=15")
      .then((response) => response.json())
      .then((result) => {
        let html = ''
        for (let object of result.data) {
          html += `<tr>
            <th style="text-align: center;">${ object.id }</th>
            <td style="text-align: center;">${ object.ip }</td>
            <td style="text-align: center;">${ object.pai }</td>
            <td style="text-align: center;">${ object.endereco }</td>
            <td style="text-align: center;">${ object.temperatura }°C</td>
            <td style="text-align: center;">${ fdt(object.data_hora) }</td>
          </tr>`
        }
        qs('#auto-tbody').innerHTML = html
      })
      .catch((error) => console.error(error))
  </script>
{% endblock %}